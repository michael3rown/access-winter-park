(function($){$(function(){pyro.generate_slug('input[name="title"]','input[name="abbrev"]');var open_sections=$.cookie('nav_groups');if(open_sections){$('section[rel="'+open_sections+'"] .item').slideDown(200).removeClass('collapsed');}else{$('.box .item:first').slideDown(200).removeClass('collapsed');}
$('.box .title').click(function(){window.scrollTo(0,0);if($(this).next('section.item').hasClass('collapsed')){$('.box .item').slideUp(200).addClass('collapsed');$.cookie('nav_groups',$(this).parents('.box').attr('rel'),{expires:1,path:window.location.pathname});$(this).next('section.collapsed').slideDown(200).removeClass('collapsed');}});$('a.ajax').live('click',function(){var id=$(this).attr('rel');if($(this).hasClass('add')){$('.group-'+id+' #link-list a').removeClass('selected');}
$('div#link-details.group-'+id+'').load($(this).attr('href'),'',function(){$('div#link-details.group-'+id+'').fadeIn();var title=$('#title-value-'+id).html();$('section.box .title h4.group-title-'+id).html(title);pyro.chosen();});return false;});$('#nav-create button:submit').live('click',function(e){e.preventDefault();$.post(SITE_URL+'admin/navigation/create',$('#nav-create').serialize(),function(message){if(message=='success'){window.location.href=window.location}
else{$('.notification').remove();$('div#content-body').prepend(message);$(".notification").fadeIn("slow");}});});$('#nav-edit button:submit').live('click',function(e){e.preventDefault();$.post(SITE_URL+'admin/navigation/edit/'+$('input[name="link_id"]').val(),$('#nav-edit').serialize(),function(message){if(message=='success'){window.location.href=window.location}
else{$('.notification').remove();$('div#content-body').prepend(message);$(".notification").fadeIn("slow");}});});$('input[name="link_type"]').live('change',function(){$(this).parents('ul').find('#navigation-'+$(this).val()).show().siblings().hide().find('input:not([value="http://"]), select').val('');}).filter(':checked').change();$('#link-list li a').livequery('click',function()
{var id=$(this).attr('rel');link_id=$(this).attr('alt');$('.group-'+id+' #link-list a').removeClass('selected');$(this).addClass('selected');$('div#link-details.group-'+id+'').load(SITE_URL+'admin/navigation/ajax_link_details/'+link_id,'',function(){$('div#link-details.group-'+id+'').fadeIn();});$('section.box .title h4.group-title-'+id).html('');return false;});$('.box:visible ul.sortable').livequery(function(){$item_list=$(this);$url='admin/navigation/order';$cookie='open_links';$data_callback=function(event,ui){return{'group':ui.item.parents('section.box').attr('rel')};}
pyro.sort_tree($item_list,$url,$cookie,$data_callback);});});})(jQuery);
